#var(Residuals - seasonal.alone)
# Still the highest
unemployment.s.ts <- data.frame(Year, Oscillatory, Trend, Residuals, seasonal.alone)
unemployment.s.ts.long <- unemployment.s.ts %>% gather(type, UNDATANSA, seasonal.alone:Residuals:Oscillatory)
ggplot(unemployment.s.ts.long, aes(x = Year, y = UNDATANSA)) + geom_line() + facet_wrap(~type, ncol = 1)
# Of all the components, it seems like the oscillatory component explains the greatest amount of the variation seen in the original plot from above. Seem to be at least 6 cycles in unemployment over the years, seemingly pretty irregular. Trend explains some of the variance, but there doesn't seem to be much of an actual pattern to it, slow increase until 1980 then a slight decrease until 2000 and a slight increase again after that. Seasonal variation regularly explains a decent amount of the variation, so seasonality deffinitely has an impact on unemployment, but it isn't huge, and interestingly it seems to be decreasing with time.
housing <- read.csv("./HOUST.csv", head = TRUE)
housing$NewDate <- seq(1959.000, 2017.000, length = 697)
unemployment.post1959 <- unemployment[133:829,]
housing.plot <- ggplot(housing, aes(x = NewDate, y = 1/HOUST)) + geom_line() +labs(title = "Number of new homes beginning construction per month", x = "Date", y = "Housing starts (thousands)")
unemployment.plot <- ggplot(unemployment.post1959, aes(x = NewDate, y = UNRATENSA)) + geom_line()  + labs(title = "Unadjusted monthly US unemployment rate", x= "Date", y = "Unemployment rate")
grid.arrange(housing.plot, unemployment.plot)
housing <- read.csv("./HOUST.csv", head = TRUE)
housing$NewDate <- seq(1959.000, 2017.000, length = 697)
unemployment.post1959 <- unemployment[133:829,]
housing.plot <- ggplot(housing, aes(x = NewDate, y = HOUST)) + geom_line() +labs(title = "Number of new homes beginning construction per month", x = "Date", y = "Housing starts (thousands)")
unemployment.plot <- ggplot(unemployment.post1959, aes(x = NewDate, y = UNRATENSA)) + geom_line()  + labs(title = "Unadjusted monthly US unemployment rate", x= "Date", y = "Unemployment rate")
grid.arrange(housing.plot, unemployment.plot)
housing <- read.csv("./HOUST.csv", head = TRUE)
housing$NewDate <- seq(1959.000, 2017.000, length = 697)
unemployment.post1959 <- unemployment[133:829,]
housing.plot <- ggplot(housing, aes(x = NewDate, y = 1/HOUST)) + geom_line() +labs(title = "Number of new homes beginning construction per month", x = "Date", y = "Housing starts (thousands)")
unemployment.plot <- ggplot(unemployment.post1959, aes(x = NewDate, y = UNRATENSA)) + geom_line()  + labs(title = "Unadjusted monthly US unemployment rate", x= "Date", y = "Unemployment rate")
grid.arrange(housing.plot, unemployment.plot)
housing <- read.csv("./HOUST.csv", head = TRUE)
housing$NewDate <- seq(1959.000, 2017.000, length = 697)
unemployment.post1959 <- unemployment[133:829,]
housing.plot <- ggplot(housing, aes(x = NewDate, y = HOUST)) + geom_line() +labs(title = "Number of new homes beginning construction per month", x = "Date", y = "Number of Housing starts (thousands")
unemployment.plot <- ggplot(unemployment.post1959, aes(x = NewDate, y = 1/UNRATENSA)) + geom_line()  + labs(title = "Unadjusted monthly US unemployment rate", x= "Date", y = "Unemployment rate")
grid.arrange(housing.plot, unemployment.plot)
housing <- read.csv("./HOUST.csv", head = TRUE)
housing$NewDate <- seq(1959.000, 2017.000, length = 697)
unemployment.post1959 <- unemployment[133:829,]
housing.plot <- ggplot(housing, aes(x = NewDate, y = HOUST)) + geom_line() +labs(title = "Number of new homes beginning construction per month", x = "Date", y = "Number of Housing starts (thousands")
unemployment.plot <- ggplot(unemployment.post1959, aes(x = NewDate, y = 1-UNRATENSA)) + geom_line()  + labs(title = "Unadjusted monthly US unemployment rate", x= "Date", y = "Unemployment rate")
grid.arrange(housing.plot, unemployment.plot)
housing <- read.csv("./HOUST.csv", head = TRUE)
housing$NewDate <- seq(1959.000, 2017.000, length = 697)
unemployment.post1959 <- unemployment[133:829,]
housing.plot <- ggplot(housing, aes(x = NewDate, y = HOUST)) + geom_line() +labs(title = "Number of new homes beginning construction per month", x = "Date", y = "Number of Housing starts (thousands")
unemployment.plot <- ggplot(unemployment.post1959, aes(x = NewDate, y = UNRATENSA)) + geom_line()  + labs(title = "Unadjusted monthly US unemployment rate", x= "Date", y = "Unemployment rate")
grid.arrange(housing.plot, unemployment.plot)
housing <- read.csv("./HOUST.csv", head = TRUE)
housing$NewDate <- seq(1959.000, 2017.000, length = 697)
unemployment.post1959 <- unemployment[133:829,]
housing.plot <- ggplot(housing, aes(x = NewDate, y = HOUST)) + geom_line() +labs(title = "Number of new homes beginning construction per month", x = "Date", y = "Number of Housing starts (thousands")
unemployment.plot <- ggplot(unemployment.post1959, aes(x = NewDate, y = -(100-UNRATENSA))) + geom_line()  + labs(title = "Unadjusted monthly US unemployment rate", x= "Date", y = "Unemployment rate")
grid.arrange(housing.plot, unemployment.plot)
housing <- read.csv("./HOUST.csv", head = TRUE)
housing$NewDate <- seq(1959.000, 2017.000, length = 697)
unemployment.post1959 <- unemployment[133:829,]
housing.plot <- ggplot(housing, aes(x = NewDate, y = HOUST)) + geom_line() +labs(title = "Number of new homes beginning construction per month", x = "Date", y = "Number of Housing starts (thousands")
unemployment.plot <- ggplot(unemployment.post1959, aes(x = NewDate, y = UNRATENSA)) + geom_line()  + labs(title = "Unadjusted monthly US unemployment rate", x= "Date", y = "Unemployment rate")
grid.arrange(housing.plot, unemployment.plot)
housing <- read.csv("./HOUST.csv", head = TRUE)
housing$NewDate <- seq(1959.000, 2017.000, length = 697)
unemployment.post1959 <- unemployment[133:829,]
housing.plot <- ggplot(housing, aes(x = NewDate, y = HOUST)) + geom_line() +labs(title = "Number of new homes beginning construction per month", x = "Date", y = "Housing starts (thousands")
unemployment.plot <- ggplot(unemployment.post1959, aes(x = NewDate, y = UNRATENSA)) + geom_line()  + labs(title = "Unadjusted monthly US unemployment rate", x= "Date", y = "Unemployment rate")
grid.arrange(housing.plot, unemployment.plot)
housing <- read.csv("./HOUST.csv", head = TRUE)
housing$NewDate <- seq(1959.000, 2017.000, length = 697)
unemployment.post1959 <- unemployment[133:829,]
housing.plot <- ggplot(housing, aes(x = NewDate, y = HOUST)) + geom_line() +labs(title = "Number of new homes beginning construction per month", x = "Date", y = "Housing starts (thousands")
unemployment.plot <- ggplot(unemployment.post1959, aes(x = NewDate, y = UNRATENSA)) + geom_line()  + labs(title = "Unadjusted monthly US unemployment rate", x= "Date", y = "Unemployment rate") + scale_y_reverse()
grid.arrange(housing.plot, unemployment.plot)
housing <- read.csv("./HOUST.csv", head = TRUE)
housing$NewDate <- seq(1959.000, 2017.000, length = 697)
unemployment.post1959 <- unemployment[133:829,]
housing.plot <- ggplot(housing, aes(x = NewDate, y = HOUST)) + geom_line() +labs(title = "Number of new homes beginning construction per month", x = "Date", y = "Housing starts (thousands") + scale_y_reverse()
unemployment.plot <- ggplot(unemployment.post1959, aes(x = NewDate, y = UNRATENSA)) + geom_line()  + labs(title = "Unadjusted monthly US unemployment rate", x= "Date", y = "Unemployment rate")
grid.arrange(housing.plot, unemployment.plot)
unemployment <- read.csv("./UNRATENSA.csv", head = TRUE)
library(ggplot2)
library(broom)
library(tidyr)
library(gridExtra)
unemployment$NewDate <- seq(1948.000, 2017.000, length = 829)
ggplot(unemployment, aes(x = NewDate, y = UNRATENSA)) + geom_point() + geom_line() + geom_smooth() + labs(title = "Unadjusted US unemployment rate")
unemployment.lo <- loess(UNRATENSA ~ NewDate, degree = 2, data = unemployment)
unemployment.lo.df <- augment(unemployment.lo)
#ggplot(unemployment.lo.df, aes(x= NewDate, y = .resid)) +geom_smooth(span = .25) + geom_line()
unemployment.lo2 <- loess(.resid~NewDate, span = 0.5, data = unemployment.lo.df)
unemployment.lo2.df <- augment(unemployment.lo2)
names(unemployment.lo2.df) = c(".resid", "NewDate", ".fitted", ".se.fit", ".resid2")
#ggplot(unemployment.lo2.df, aes(x = NewDate, y = .resid2)) + geom_point() + geom_line()
#ggplot(unemployment.lo2.df, aes(sample = .resid2)) + stat_qq()
Year <- unemployment$NewDate
Trend <- unemployment.lo.df$.fitted - mean(unemployment.lo.df$.fitted)
Oscillatory <- unemployment.lo2.df$.fitted
Residuals <- unemployment.lo2.df$.resid2
unemployment.ts <- data.frame(Year, Trend, Oscillatory, Residuals)
unemployment.ts.long <- unemployment.ts%>% gather(type, UNDATANSA, Trend: Residuals)
unemployment.ts.long$type <- factor (unemployment.ts.long$type, levels = c("Trend", "Oscillatory", "Residuals"))
#ggplot(unemployment.ts.long, aes(x=Year, y = UNDATANSA))+geom_line()+facet_grid(~type)
#var(Trend)
#var(Oscillatory)
#var(Residuals)
# Residuals explain the most here, possibly seasonal as that hasn't been pulled out yet.
seasonal <- ts(unemployment$UNRATENSA, frequency = 12)
unemployment.stl <- stl(seasonal, s.window = 15, s.degree = 0)
year.cut <- cut_number(time(unemployment$NewDate), n=5)
unemployment2 <- data.frame(year=unemployment$NewDate, unemployment.stl$time.series, year.cut)
#ggplot(unemployment2, aes(x=year, y=seasonal)) + geom_line() + facet_wrap(~year.cut, ncol=1, scales="free_x")
monthplot(unemployment.stl, choice="seasonal")
# So, unemployment is highest after the holidays end (Jan-March), seems to be a definite seasonal component.
#ggplot(unemployment2, aes(x= Year, y = Trend+remainder)) + geom_line() + geom_smooth()
# Seems to show that when seasonal info is removed, there is not really any clear trend, just residual noise left over.
#unemployment.month <- data.frame(unemployment2, month = factor(1:12)) # Can't get to work for above plot like Brad does, necessary though?
seasonal.alone <- unemployment2$seasonal
#var(seasonal.alone)
# Super low
#var(Residuals - seasonal.alone)
# Still the highest
unemployment.s.ts <- data.frame(Year, Oscillatory, Trend, Residuals, seasonal.alone)
unemployment.s.ts.long <- unemployment.s.ts %>% gather(type, UNDATANSA, seasonal.alone:Residuals:Oscillatory)
ggplot(unemployment.s.ts.long, aes(x = Year, y = UNDATANSA)) + geom_line() + facet_wrap(~type, ncol = 1)
# Of all the components, it seems like the oscillatory component explains the greatest amount of the variation seen in the original plot from above. Seem to be at least 6 cycles in unemployment over the years, seemingly pretty irregular. Trend explains some of the variance, but there doesn't seem to be much of an actual pattern to it, slow increase until 1980 then a slight decrease until 2000 and a slight increase again after that. Seasonal variation regularly explains a decent amount of the variation, so seasonality deffinitely has an impact on unemployment, but it isn't huge, and interestingly it seems to be decreasing with time.
unemployment <- read.csv("./UNRATENSA.csv", head = TRUE)
library(ggplot2)
library(broom)
library(tidyr)
library(gridExtra)
unemployment$NewDate <- seq(1948.000, 2017.000, length = 829)
ggplot(unemployment, aes(x = NewDate, y = UNRATENSA)) + geom_point() + geom_line() + geom_smooth() + labs(title = "Unadjusted US unemployment rate")
unemployment.lo <- loess(UNRATENSA ~ NewDate, degree = 2, data = unemployment)
unemployment.lo.df <- augment(unemployment.lo)
#ggplot(unemployment.lo.df, aes(x= NewDate, y = .resid)) +geom_smooth(span = .25) + geom_line()
unemployment.lo2 <- loess(.resid~NewDate, span = 1, data = unemployment.lo.df)
unemployment.lo2.df <- augment(unemployment.lo2)
names(unemployment.lo2.df) = c(".resid", "NewDate", ".fitted", ".se.fit", ".resid2")
#ggplot(unemployment.lo2.df, aes(x = NewDate, y = .resid2)) + geom_point() + geom_line()
#ggplot(unemployment.lo2.df, aes(sample = .resid2)) + stat_qq()
Year <- unemployment$NewDate
Trend <- unemployment.lo.df$.fitted - mean(unemployment.lo.df$.fitted)
Oscillatory <- unemployment.lo2.df$.fitted
Residuals <- unemployment.lo2.df$.resid2
unemployment.ts <- data.frame(Year, Trend, Oscillatory, Residuals)
unemployment.ts.long <- unemployment.ts%>% gather(type, UNDATANSA, Trend: Residuals)
unemployment.ts.long$type <- factor (unemployment.ts.long$type, levels = c("Trend", "Oscillatory", "Residuals"))
#ggplot(unemployment.ts.long, aes(x=Year, y = UNDATANSA))+geom_line()+facet_grid(~type)
#var(Trend)
#var(Oscillatory)
#var(Residuals)
# Residuals explain the most here, possibly seasonal as that hasn't been pulled out yet.
seasonal <- ts(unemployment$UNRATENSA, frequency = 12)
unemployment.stl <- stl(seasonal, s.window = 15, s.degree = 0)
year.cut <- cut_number(time(unemployment$NewDate), n=5)
unemployment2 <- data.frame(year=unemployment$NewDate, unemployment.stl$time.series, year.cut)
#ggplot(unemployment2, aes(x=year, y=seasonal)) + geom_line() + facet_wrap(~year.cut, ncol=1, scales="free_x")
monthplot(unemployment.stl, choice="seasonal")
# So, unemployment is highest after the holidays end (Jan-March), seems to be a definite seasonal component.
#ggplot(unemployment2, aes(x= Year, y = Trend+remainder)) + geom_line() + geom_smooth()
# Seems to show that when seasonal info is removed, there is not really any clear trend, just residual noise left over.
#unemployment.month <- data.frame(unemployment2, month = factor(1:12)) # Can't get to work for above plot like Brad does, necessary though?
seasonal.alone <- unemployment2$seasonal
#var(seasonal.alone)
# Super low
#var(Residuals - seasonal.alone)
# Still the highest
unemployment.s.ts <- data.frame(Year, Oscillatory, Trend, Residuals, seasonal.alone)
unemployment.s.ts.long <- unemployment.s.ts %>% gather(type, UNDATANSA, seasonal.alone:Residuals:Oscillatory)
ggplot(unemployment.s.ts.long, aes(x = Year, y = UNDATANSA)) + geom_line() + facet_wrap(~type, ncol = 1)
# Of all the components, it seems like the oscillatory component explains the greatest amount of the variation seen in the original plot from above. Seem to be at least 6 cycles in unemployment over the years, seemingly pretty irregular. Trend explains some of the variance, but there doesn't seem to be much of an actual pattern to it, slow increase until 1980 then a slight decrease until 2000 and a slight increase again after that. Seasonal variation regularly explains a decent amount of the variation, so seasonality deffinitely has an impact on unemployment, but it isn't huge, and interestingly it seems to be decreasing with time.
unemployment <- read.csv("./UNRATENSA.csv", head = TRUE)
library(ggplot2)
library(broom)
library(tidyr)
library(gridExtra)
unemployment$NewDate <- seq(1948.000, 2017.000, length = 829)
ggplot(unemployment, aes(x = NewDate, y = UNRATENSA)) + geom_point() + geom_line() + geom_smooth() + labs(title = "Unadjusted US unemployment rate")
unemployment.lo <- loess(UNRATENSA ~ NewDate, degree = 2, data = unemployment)
unemployment.lo.df <- augment(unemployment.lo)
#ggplot(unemployment.lo.df, aes(x= NewDate, y = .resid)) +geom_smooth(span = .25) + geom_line()
unemployment.lo2 <- loess(.resid~NewDate, span = .10, data = unemployment.lo.df)
unemployment.lo2.df <- augment(unemployment.lo2)
names(unemployment.lo2.df) = c(".resid", "NewDate", ".fitted", ".se.fit", ".resid2")
#ggplot(unemployment.lo2.df, aes(x = NewDate, y = .resid2)) + geom_point() + geom_line()
#ggplot(unemployment.lo2.df, aes(sample = .resid2)) + stat_qq()
Year <- unemployment$NewDate
Trend <- unemployment.lo.df$.fitted - mean(unemployment.lo.df$.fitted)
Oscillatory <- unemployment.lo2.df$.fitted
Residuals <- unemployment.lo2.df$.resid2
unemployment.ts <- data.frame(Year, Trend, Oscillatory, Residuals)
unemployment.ts.long <- unemployment.ts%>% gather(type, UNDATANSA, Trend: Residuals)
unemployment.ts.long$type <- factor (unemployment.ts.long$type, levels = c("Trend", "Oscillatory", "Residuals"))
#ggplot(unemployment.ts.long, aes(x=Year, y = UNDATANSA))+geom_line()+facet_grid(~type)
#var(Trend)
#var(Oscillatory)
#var(Residuals)
# Residuals explain the most here, possibly seasonal as that hasn't been pulled out yet.
seasonal <- ts(unemployment$UNRATENSA, frequency = 12)
unemployment.stl <- stl(seasonal, s.window = 15, s.degree = 0)
year.cut <- cut_number(time(unemployment$NewDate), n=5)
unemployment2 <- data.frame(year=unemployment$NewDate, unemployment.stl$time.series, year.cut)
#ggplot(unemployment2, aes(x=year, y=seasonal)) + geom_line() + facet_wrap(~year.cut, ncol=1, scales="free_x")
monthplot(unemployment.stl, choice="seasonal")
# So, unemployment is highest after the holidays end (Jan-March), seems to be a definite seasonal component.
#ggplot(unemployment2, aes(x= Year, y = Trend+remainder)) + geom_line() + geom_smooth()
# Seems to show that when seasonal info is removed, there is not really any clear trend, just residual noise left over.
#unemployment.month <- data.frame(unemployment2, month = factor(1:12)) # Can't get to work for above plot like Brad does, necessary though?
seasonal.alone <- unemployment2$seasonal
#var(seasonal.alone)
# Super low
#var(Residuals - seasonal.alone)
# Still the highest
unemployment.s.ts <- data.frame(Year, Oscillatory, Trend, Residuals, seasonal.alone)
unemployment.s.ts.long <- unemployment.s.ts %>% gather(type, UNDATANSA, seasonal.alone:Residuals:Oscillatory)
ggplot(unemployment.s.ts.long, aes(x = Year, y = UNDATANSA)) + geom_line() + facet_wrap(~type, ncol = 1)
# Of all the components, it seems like the oscillatory component explains the greatest amount of the variation seen in the original plot from above. Seem to be at least 6 cycles in unemployment over the years, seemingly pretty irregular. Trend explains some of the variance, but there doesn't seem to be much of an actual pattern to it, slow increase until 1980 then a slight decrease until 2000 and a slight increase again after that. Seasonal variation regularly explains a decent amount of the variation, so seasonality deffinitely has an impact on unemployment, but it isn't huge, and interestingly it seems to be decreasing with time.
unemployment <- read.csv("./UNRATENSA.csv", head = TRUE)
library(ggplot2)
library(broom)
library(tidyr)
library(gridExtra)
unemployment$NewDate <- seq(1948.000, 2017.000, length = 829)
ggplot(unemployment, aes(x = NewDate, y = UNRATENSA)) + geom_point() + geom_line() + geom_smooth() + labs(title = "Unadjusted US unemployment rate")
unemployment.lo <- loess(UNRATENSA ~ NewDate, degree = 2, data = unemployment)
unemployment.lo.df <- augment(unemployment.lo)
#ggplot(unemployment.lo.df, aes(x= NewDate, y = .resid)) +geom_smooth(span = .25) + geom_line()
unemployment.lo2 <- loess(.resid~NewDate, span = .05, data = unemployment.lo.df)
unemployment.lo2.df <- augment(unemployment.lo2)
names(unemployment.lo2.df) = c(".resid", "NewDate", ".fitted", ".se.fit", ".resid2")
#ggplot(unemployment.lo2.df, aes(x = NewDate, y = .resid2)) + geom_point() + geom_line()
#ggplot(unemployment.lo2.df, aes(sample = .resid2)) + stat_qq()
Year <- unemployment$NewDate
Trend <- unemployment.lo.df$.fitted - mean(unemployment.lo.df$.fitted)
Oscillatory <- unemployment.lo2.df$.fitted
Residuals <- unemployment.lo2.df$.resid2
unemployment.ts <- data.frame(Year, Trend, Oscillatory, Residuals)
unemployment.ts.long <- unemployment.ts%>% gather(type, UNDATANSA, Trend: Residuals)
unemployment.ts.long$type <- factor (unemployment.ts.long$type, levels = c("Trend", "Oscillatory", "Residuals"))
#ggplot(unemployment.ts.long, aes(x=Year, y = UNDATANSA))+geom_line()+facet_grid(~type)
#var(Trend)
#var(Oscillatory)
#var(Residuals)
# Residuals explain the most here, possibly seasonal as that hasn't been pulled out yet.
seasonal <- ts(unemployment$UNRATENSA, frequency = 12)
unemployment.stl <- stl(seasonal, s.window = 15, s.degree = 0)
year.cut <- cut_number(time(unemployment$NewDate), n=5)
unemployment2 <- data.frame(year=unemployment$NewDate, unemployment.stl$time.series, year.cut)
#ggplot(unemployment2, aes(x=year, y=seasonal)) + geom_line() + facet_wrap(~year.cut, ncol=1, scales="free_x")
monthplot(unemployment.stl, choice="seasonal")
# So, unemployment is highest after the holidays end (Jan-March), seems to be a definite seasonal component.
#ggplot(unemployment2, aes(x= Year, y = Trend+remainder)) + geom_line() + geom_smooth()
# Seems to show that when seasonal info is removed, there is not really any clear trend, just residual noise left over.
#unemployment.month <- data.frame(unemployment2, month = factor(1:12)) # Can't get to work for above plot like Brad does, necessary though?
seasonal.alone <- unemployment2$seasonal
#var(seasonal.alone)
# Super low
#var(Residuals - seasonal.alone)
# Still the highest
unemployment.s.ts <- data.frame(Year, Oscillatory, Trend, Residuals, seasonal.alone)
unemployment.s.ts.long <- unemployment.s.ts %>% gather(type, UNDATANSA, seasonal.alone:Residuals:Oscillatory)
ggplot(unemployment.s.ts.long, aes(x = Year, y = UNDATANSA)) + geom_line() + facet_wrap(~type, ncol = 1)
# Of all the components, it seems like the oscillatory component explains the greatest amount of the variation seen in the original plot from above. Seem to be at least 6 cycles in unemployment over the years, seemingly pretty irregular. Trend explains some of the variance, but there doesn't seem to be much of an actual pattern to it, slow increase until 1980 then a slight decrease until 2000 and a slight increase again after that. Seasonal variation regularly explains a decent amount of the variation, so seasonality deffinitely has an impact on unemployment, but it isn't huge, and interestingly it seems to be decreasing with time.
unemployment <- read.csv("./UNRATENSA.csv", head = TRUE)
library(ggplot2)
library(broom)
library(tidyr)
library(gridExtra)
unemployment$NewDate <- seq(1948.000, 2017.000, length = 829)
ggplot(unemployment, aes(x = NewDate, y = UNRATENSA)) + geom_point() + geom_line() + geom_smooth() + labs(title = "Unadjusted US unemployment rate")
unemployment.lo <- loess(UNRATENSA ~ NewDate, degree = 2, data = unemployment)
unemployment.lo.df <- augment(unemployment.lo)
#ggplot(unemployment.lo.df, aes(x= NewDate, y = .resid)) +geom_smooth(span = .25) + geom_line()
unemployment.lo2 <- loess(.resid~NewDate, span = 0, data = unemployment.lo.df)
unemployment <- read.csv("./UNRATENSA.csv", head = TRUE)
library(ggplot2)
library(broom)
library(tidyr)
library(gridExtra)
unemployment$NewDate <- seq(1948.000, 2017.000, length = 829)
ggplot(unemployment, aes(x = NewDate, y = UNRATENSA)) + geom_point() + geom_line() + geom_smooth() + labs(title = "Unadjusted US unemployment rate")
unemployment.lo <- loess(UNRATENSA ~ NewDate, degree = 2, data = unemployment)
unemployment.lo.df <- augment(unemployment.lo)
#ggplot(unemployment.lo.df, aes(x= NewDate, y = .resid)) +geom_smooth(span = .25) + geom_line()
unemployment.lo2 <- loess(.resid~NewDate, span = 0.00001, data = unemployment.lo.df)
unemployment <- read.csv("./UNRATENSA.csv", head = TRUE)
library(ggplot2)
library(broom)
library(tidyr)
library(gridExtra)
unemployment$NewDate <- seq(1948.000, 2017.000, length = 829)
ggplot(unemployment, aes(x = NewDate, y = UNRATENSA)) + geom_point() + geom_line() + geom_smooth() + labs(title = "Unadjusted US unemployment rate")
unemployment.lo <- loess(UNRATENSA ~ NewDate, degree = 2, data = unemployment)
unemployment.lo.df <- augment(unemployment.lo)
unemployment <- read.csv("./UNRATENSA.csv", head = TRUE)
library(ggplot2)
library(broom)
library(tidyr)
library(gridExtra)
unemployment$NewDate <- seq(1948.000, 2017.000, length = 829)
ggplot(unemployment, aes(x = NewDate, y = UNRATENSA)) + geom_point() + geom_line() + geom_smooth() + labs(title = "Unadjusted US unemployment rate")
unemployment.lo <- loess(UNRATENSA ~ NewDate, degree = 2, data = unemployment)
unemployment.lo.df <- augment(unemployment.lo)
#ggplot(unemployment.lo.df, aes(x= NewDate, y = .resid)) +geom_smooth(span = .25) + geom_line()
unemployment.lo2 <- loess(.resid~NewDate, span = 0.001, data = unemployment.lo.df)
unemployment <- read.csv("./UNRATENSA.csv", head = TRUE)
library(ggplot2)
library(broom)
library(tidyr)
library(gridExtra)
unemployment$NewDate <- seq(1948.000, 2017.000, length = 829)
ggplot(unemployment, aes(x = NewDate, y = UNRATENSA)) + geom_point() + geom_line() + geom_smooth() + labs(title = "Unadjusted US unemployment rate")
unemployment.lo <- loess(UNRATENSA ~ NewDate, degree = 2, data = unemployment)
unemployment.lo.df <- augment(unemployment.lo)
#ggplot(unemployment.lo.df, aes(x= NewDate, y = .resid)) +geom_smooth(span = .25) + geom_line()
unemployment.lo2 <- loess(.resid~NewDate, span = 0.01, data = unemployment.lo.df)
unemployment.lo2.df <- augment(unemployment.lo2)
names(unemployment.lo2.df) = c(".resid", "NewDate", ".fitted", ".se.fit", ".resid2")
#ggplot(unemployment.lo2.df, aes(x = NewDate, y = .resid2)) + geom_point() + geom_line()
#ggplot(unemployment.lo2.df, aes(sample = .resid2)) + stat_qq()
Year <- unemployment$NewDate
Trend <- unemployment.lo.df$.fitted - mean(unemployment.lo.df$.fitted)
Oscillatory <- unemployment.lo2.df$.fitted
Residuals <- unemployment.lo2.df$.resid2
unemployment.ts <- data.frame(Year, Trend, Oscillatory, Residuals)
unemployment.ts.long <- unemployment.ts%>% gather(type, UNDATANSA, Trend: Residuals)
unemployment.ts.long$type <- factor (unemployment.ts.long$type, levels = c("Trend", "Oscillatory", "Residuals"))
#ggplot(unemployment.ts.long, aes(x=Year, y = UNDATANSA))+geom_line()+facet_grid(~type)
#var(Trend)
#var(Oscillatory)
#var(Residuals)
# Residuals explain the most here, possibly seasonal as that hasn't been pulled out yet.
seasonal <- ts(unemployment$UNRATENSA, frequency = 12)
unemployment.stl <- stl(seasonal, s.window = 15, s.degree = 0)
year.cut <- cut_number(time(unemployment$NewDate), n=5)
unemployment2 <- data.frame(year=unemployment$NewDate, unemployment.stl$time.series, year.cut)
#ggplot(unemployment2, aes(x=year, y=seasonal)) + geom_line() + facet_wrap(~year.cut, ncol=1, scales="free_x")
monthplot(unemployment.stl, choice="seasonal")
# So, unemployment is highest after the holidays end (Jan-March), seems to be a definite seasonal component.
#ggplot(unemployment2, aes(x= Year, y = Trend+remainder)) + geom_line() + geom_smooth()
# Seems to show that when seasonal info is removed, there is not really any clear trend, just residual noise left over.
#unemployment.month <- data.frame(unemployment2, month = factor(1:12)) # Can't get to work for above plot like Brad does, necessary though?
seasonal.alone <- unemployment2$seasonal
#var(seasonal.alone)
# Super low
#var(Residuals - seasonal.alone)
# Still the highest
unemployment.s.ts <- data.frame(Year, Oscillatory, Trend, Residuals, seasonal.alone)
unemployment.s.ts.long <- unemployment.s.ts %>% gather(type, UNDATANSA, seasonal.alone:Residuals:Oscillatory)
ggplot(unemployment.s.ts.long, aes(x = Year, y = UNDATANSA)) + geom_line() + facet_wrap(~type, ncol = 1)
# Of all the components, it seems like the oscillatory component explains the greatest amount of the variation seen in the original plot from above. Seem to be at least 6 cycles in unemployment over the years, seemingly pretty irregular. Trend explains some of the variance, but there doesn't seem to be much of an actual pattern to it, slow increase until 1980 then a slight decrease until 2000 and a slight increase again after that. Seasonal variation regularly explains a decent amount of the variation, so seasonality deffinitely has an impact on unemployment, but it isn't huge, and interestingly it seems to be decreasing with time.
ggplot(unemployment, aes(x = NewDate, y = UNRATENSA)) + geom_point() + geom_line() + geom_smooth() + labs(title = "Unadjusted US unemployment rate")
unemployment <- read.csv("./UNRATENSA.csv", head = TRUE)
library(ggplot2)
library(broom)
library(tidyr)
library(gridExtra)
unemployment$NewDate <- seq(1948.000, 2017.000, length = 829)
ggplot(unemployment, aes(x = NewDate, y = UNRATENSA)) + geom_point() + geom_line() + geom_smooth() + labs(title = "Unadjusted US unemployment rate")
unemployment.lo <- loess(UNRATENSA ~ NewDate, degree = 2, data = unemployment)
unemployment.lo.df <- augment(unemployment.lo)
#ggplot(unemployment.lo.df, aes(x= NewDate, y = .resid)) +geom_smooth(span = .25) + geom_line()
unemployment.lo2 <- loess(.resid~NewDate, span = 0.01, data = unemployment.lo.df)
unemployment.lo2.df <- augment(unemployment.lo2)
names(unemployment.lo2.df) = c(".resid", "NewDate", ".fitted", ".se.fit", ".resid2")
#ggplot(unemployment.lo2.df, aes(x = NewDate, y = .resid2)) + geom_point() + geom_line()
#ggplot(unemployment.lo2.df, aes(sample = .resid2)) + stat_qq()
Year <- unemployment$NewDate
Trend <- unemployment.lo.df$.fitted - mean(unemployment.lo.df$.fitted)
Oscillatory <- unemployment.lo2.df$.fitted
Residuals <- unemployment.lo2.df$.resid2
unemployment.ts <- data.frame(Year, Trend, Oscillatory, Residuals)
unemployment.ts.long <- unemployment.ts%>% gather(type, UNDATANSA, Trend: Residuals)
unemployment.ts.long$type <- factor (unemployment.ts.long$type, levels = c("Trend", "Oscillatory", "Residuals"))
#ggplot(unemployment.ts.long, aes(x=Year, y = UNDATANSA))+geom_line()+facet_grid(~type)
#var(Trend)
#var(Oscillatory)
#var(Residuals)
# Residuals explain the most here, possibly seasonal as that hasn't been pulled out yet.
seasonal <- ts(unemployment$UNRATENSA, frequency = 12)
unemployment.stl <- stl(seasonal, s.window = 15, s.degree = 0)
year.cut <- cut_number(time(unemployment$NewDate), n=5)
unemployment2 <- data.frame(year=unemployment$NewDate, unemployment.stl$time.series, year.cut)
#ggplot(unemployment2, aes(x=year, y=seasonal)) + geom_line() + facet_wrap(~year.cut, ncol=1, scales="free_x")
monthplot(unemployment.stl, choice="seasonal")
# So, unemployment is highest after the holidays end (Jan-March), seems to be a definite seasonal component.
#ggplot(unemployment2, aes(x= Year, y = Trend+remainder)) + geom_line() + geom_smooth()
# Seems to show that when seasonal info is removed, there is not really any clear trend, just residual noise left over.
#unemployment.month <- data.frame(unemployment2, month = factor(1:12)) # Can't get to work for above plot like Brad does, necessary though?
seasonal.alone <- unemployment2$seasonal
#var(seasonal.alone)
# Super low
#var(Residuals - seasonal.alone)
# Still the highest
unemployment.s.ts <- data.frame(Year, Oscillatory, Trend, Residuals, seasonal.alone)
unemployment.s.ts.long <- unemployment.s.ts %>% gather(type, UNDATANSA, seasonal.alone:Residuals:Oscillatory)
ggplot(unemployment.s.ts.long, aes(x = Year, y = UNDATANSA)) + geom_line() + facet_wrap(~type, ncol = 1)
# Of all the components, it seems like the oscillatory component explains the greatest amount of the variation seen in the original plot from above. Seem to be at least 6 cycles in unemployment over the years, seemingly pretty irregular. Trend explains some of the variance, but there doesn't seem to be much of an actual pattern to it, slow increase until 1980 then a slight decrease until 2000 and a slight increase again after that. Seasonal variation regularly explains a decent amount of the variation, so seasonality deffinitely has an impact on unemployment, but it isn't huge, and interestingly it seems to be decreasing with time.
monthplot(unemployment.stl, choice="seasonal")
?monthplot
?stl
unemployment <- read.csv("./UNRATENSA.csv", head = TRUE)
library(ggplot2)
library(broom)
library(tidyr)
library(gridExtra)
unemployment$NewDate <- seq(1948.000, 2017.000, length = 829)
ggplot(unemployment, aes(x = NewDate, y = UNRATENSA)) + geom_point() + geom_line() + geom_smooth() + labs(title = "Unadjusted US unemployment rate")
unemployment.lo <- loess(UNRATENSA ~ NewDate, degree = 2, data = unemployment)
unemployment.lo.df <- augment(unemployment.lo)
#ggplot(unemployment.lo.df, aes(x= NewDate, y = .resid)) +geom_smooth(span = .25) + geom_line()
unemployment.lo2 <- loess(.resid~NewDate, span = 0.01, data = unemployment.lo.df)
unemployment.lo2.df <- augment(unemployment.lo2)
names(unemployment.lo2.df) = c(".resid", "NewDate", ".fitted", ".se.fit", ".resid2")
#ggplot(unemployment.lo2.df, aes(x = NewDate, y = .resid2)) + geom_point() + geom_line()
#ggplot(unemployment.lo2.df, aes(sample = .resid2)) + stat_qq()
Year <- unemployment$NewDate
Trend <- unemployment.lo.df$.fitted - mean(unemployment.lo.df$.fitted)
Oscillatory <- unemployment.lo2.df$.fitted
Residuals <- unemployment.lo2.df$.resid2
unemployment.ts <- data.frame(Year, Trend, Oscillatory, Residuals)
unemployment.ts.long <- unemployment.ts%>% gather(type, UNDATANSA, Trend: Residuals)
unemployment.ts.long$type <- factor (unemployment.ts.long$type, levels = c("Trend", "Oscillatory", "Residuals"))
#ggplot(unemployment.ts.long, aes(x=Year, y = UNDATANSA))+geom_line()+facet_grid(~type)
#var(Trend)
#var(Oscillatory)
#var(Residuals)
# Residuals explain the most here, possibly seasonal as that hasn't been pulled out yet.
seasonal <- ts(unemployment$UNRATENSA, frequency = 12)
unemployment.stl <- stl(seasonal, s.window = 25, s.degree = 0)
year.cut <- cut_number(time(unemployment$NewDate), n=5)
unemployment2 <- data.frame(year=unemployment$NewDate, unemployment.stl$time.series, year.cut)
#ggplot(unemployment2, aes(x=year, y=seasonal)) + geom_line() + facet_wrap(~year.cut, ncol=1, scales="free_x")
monthplot(unemployment.stl, choice="seasonal")
# So, unemployment is highest after the holidays end (Jan-March), seems to be a definite seasonal component.
#ggplot(unemployment2, aes(x= Year, y = Trend+remainder)) + geom_line() + geom_smooth()
# Seems to show that when seasonal info is removed, there is not really any clear trend, just residual noise left over.
#unemployment.month <- data.frame(unemployment2, month = factor(1:12)) # Can't get to work for above plot like Brad does, necessary though?
seasonal.alone <- unemployment2$seasonal
#var(seasonal.alone)
# Super low
#var(Residuals - seasonal.alone)
# Still the highest
unemployment.s.ts <- data.frame(Year, Oscillatory, Trend, Residuals, seasonal.alone)
unemployment.s.ts.long <- unemployment.s.ts %>% gather(type, UNDATANSA, seasonal.alone:Residuals:Oscillatory)
ggplot(unemployment.s.ts.long, aes(x = Year, y = UNDATANSA)) + geom_line() + facet_wrap(~type, ncol = 1)
# Of all the components, it seems like the oscillatory component explains the greatest amount of the variation seen in the original plot from above. Seem to be at least 6 cycles in unemployment over the years, seemingly pretty irregular. Trend explains some of the variance, but there doesn't seem to be much of an actual pattern to it, slow increase until 1980 then a slight decrease until 2000 and a slight increase again after that. Seasonal variation regularly explains a decent amount of the variation, so seasonality deffinitely has an impact on unemployment, but it isn't huge, and interestingly it seems to be decreasing with time.
unemployment <- read.csv("./UNRATENSA.csv", head = TRUE)
library(ggplot2)
library(broom)
library(tidyr)
library(gridExtra)
unemployment$NewDate <- seq(1948.000, 2017.000, length = 829)
ggplot(unemployment, aes(x = NewDate, y = UNRATENSA)) + geom_point() + geom_line() + geom_smooth() + labs(title = "Unadjusted US unemployment rate")
unemployment.lo <- loess(UNRATENSA ~ NewDate, degree = 2, data = unemployment)
unemployment.lo.df <- augment(unemployment.lo)
#ggplot(unemployment.lo.df, aes(x= NewDate, y = .resid)) +geom_smooth(span = .25) + geom_line()
unemployment.lo2 <- loess(.resid~NewDate, span = 0.01, data = unemployment.lo.df)
unemployment.lo2.df <- augment(unemployment.lo2)
names(unemployment.lo2.df) = c(".resid", "NewDate", ".fitted", ".se.fit", ".resid2")
#ggplot(unemployment.lo2.df, aes(x = NewDate, y = .resid2)) + geom_point() + geom_line()
#ggplot(unemployment.lo2.df, aes(sample = .resid2)) + stat_qq()
Year <- unemployment$NewDate
Trend <- unemployment.lo.df$.fitted - mean(unemployment.lo.df$.fitted)
Oscillatory <- unemployment.lo2.df$.fitted
Residuals <- unemployment.lo2.df$.resid2
unemployment.ts <- data.frame(Year, Trend, Oscillatory, Residuals)
unemployment.ts.long <- unemployment.ts%>% gather(type, UNDATANSA, Trend: Residuals)
unemployment.ts.long$type <- factor (unemployment.ts.long$type, levels = c("Trend", "Oscillatory", "Residuals"))
#ggplot(unemployment.ts.long, aes(x=Year, y = UNDATANSA))+geom_line()+facet_grid(~type)
#var(Trend)
#var(Oscillatory)
#var(Residuals)
# Residuals explain the most here, possibly seasonal as that hasn't been pulled out yet.
seasonal <- ts(unemployment$UNRATENSA, frequency = 12)
unemployment.stl <- stl(seasonal, s.window = 29, s.degree = 0)
year.cut <- cut_number(time(unemployment$NewDate), n=5)
unemployment2 <- data.frame(year=unemployment$NewDate, unemployment.stl$time.series, year.cut)
#ggplot(unemployment2, aes(x=year, y=seasonal)) + geom_line() + facet_wrap(~year.cut, ncol=1, scales="free_x")
monthplot(unemployment.stl, choice="seasonal")
# So, unemployment is highest after the holidays end (Jan-March), seems to be a definite seasonal component.
#ggplot(unemployment2, aes(x= Year, y = Trend+remainder)) + geom_line() + geom_smooth()
# Seems to show that when seasonal info is removed, there is not really any clear trend, just residual noise left over.
#unemployment.month <- data.frame(unemployment2, month = factor(1:12)) # Can't get to work for above plot like Brad does, necessary though?
seasonal.alone <- unemployment2$seasonal
#var(seasonal.alone)
# Super low
#var(Residuals - seasonal.alone)
# Still the highest
unemployment.s.ts <- data.frame(Year, Oscillatory, Trend, Residuals, seasonal.alone)
unemployment.s.ts.long <- unemployment.s.ts %>% gather(type, UNDATANSA, seasonal.alone:Residuals:Oscillatory)
ggplot(unemployment.s.ts.long, aes(x = Year, y = UNDATANSA)) + geom_line() + facet_wrap(~type, ncol = 1)
# Of all the components, it seems like the oscillatory component explains the greatest amount of the variation seen in the original plot from above. Seem to be at least 6 cycles in unemployment over the years, seemingly pretty irregular. Trend explains some of the variance, but there doesn't seem to be much of an actual pattern to it, slow increase until 1980 then a slight decrease until 2000 and a slight increase again after that. Seasonal variation regularly explains a decent amount of the variation, so seasonality deffinitely has an impact on unemployment, but it isn't huge, and interestingly it seems to be decreasing with time.
housing <- read.csv("./HOUST.csv", head = TRUE)
housing$NewDate <- seq(1959.000, 2017.000, length = 697)
unemployment.post1959 <- unemployment[133:829,]
housing.plot <- ggplot(housing, aes(x = NewDate, y = HOUST)) + geom_line() +labs(title = "Number of new homes beginning construction per month (Y axis reversed)", x = "Date", y = "Housing starts (thousands") + scale_y_reverse()
unemployment.plot <- ggplot(unemployment.post1959, aes(x = NewDate, y = UNRATENSA)) + geom_line()  + labs(title = "Unadjusted monthly US unemployment rate", x= "Date", y = "Unemployment rate")
grid.arrange(housing.plot, unemployment.plot)
grid.arrange(housing.plot, unemployment.plot)
grid.arrange(housing.plot, unemployment.plot)
ar(seasonal.alone)
var(seasonal.alone)
var(Residuals - seasonal.alone)
var(Trend)
var(Oscillatory)
var(Residuals)
var(Trend)
var(Oscillatory)
var(Residuals)
var(seasonal.alone)
var(Residuals - seasonal.alone)
grid.arrange(housing.plot, unemployment.plot)
housing <- read.csv("./HOUST.csv", head = TRUE)
housing$NewDate <- seq(1959.000, 2017.000, length = 697)
unemployment.post1959 <- unemployment[133:829,]
housing.plot <- ggplot(housing, aes(x = NewDate, y = HOUST)) + geom_line() +labs(title = "Number of new homes constructed per month (Y axis reversed)", x = "Date", y = "Housing starts (thousands") + scale_y_reverse()
unemployment.plot <- ggplot(unemployment.post1959, aes(x = NewDate, y = UNRATENSA)) + geom_line()  + labs(title = "Unadjusted monthly US unemployment rate", x= "Date", y = "Unemployment rate")
grid.arrange(housing.plot, unemployment.plot)
